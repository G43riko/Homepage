(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{ZJtR:function(e,n,t){"use strict";t.r(n),t.d(n,"FilesModule",function(){return X});var o=t("ofXK"),i=t("3Pt+"),a=t("NA4g"),c=t("PCNd"),r=t("IYfF"),s=t("vihK"),l=function(){function e(e,n,t){this.ref=e,this.ownedImageTask=n,this.sharedImageTask=t}return Object.defineProperty(e.prototype,"percentageChanges",{get:function(){return this.ownedImageTask.percentageChanges()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"snapshotChanges",{get:function(){return this.ownedImageTask.snapshotChanges()},enumerable:!1,configurable:!0}),e}(),p=t("fXoL"),u=t("Vaw3"),g=function(){function e(e,n,t){this.storage=e,this.configService=n,this.authService=t}return e.prototype.checkFileFormat=function(e){if("image"!==e.type.split("/")[0])throw new Error("Unsupported file format")},e.prototype.getCustomMetadata=function(e,n){return{sharedWith:n,app:this.configService.get("title"),uploadedBy:e.uid,active:"true"}},e.prototype.getUniqueFileNameFromFile=function(e){return(new Date).getTime()+"_"+e.name},e.prototype.uploadFile=function(e,n,t){this.checkFileFormat(e);var o,i=this.getUniqueFileNameFromFile(e),a="images/owned/"+n.uid+"/"+i,c=this.getCustomMetadata(n,t);return t&&(o=this.storage.upload("images/shared/"+t+"/"+i,e,{customMetadata:c})),new l(this.storage.ref(a),this.storage.upload(a,e,{customMetadata:c}),o)},e.\u0275fac=function(n){return new(n||e)(p.Yb(u.a),p.Yb(s.a),p.Yb(r.a))},e.\u0275prov=p.Kb({token:e,factory:e.\u0275fac}),e}(),d=t("tyNb"),b=t("3S9H"),f=t("x4c3");function h(e,n){if(1&e&&(p.Ub(0,"figure",2),p.Ub(1,"div",3),p.Pb(2,"img",4),p.hc(3,"async"),p.Ub(4,"div",5),p.Ub(5,"span",6),p.Ub(6,"a",7),p.Ic(7,"Lake Walchen"),p.Tb(),p.Tb(),p.Ub(8,"span",8),p.Ic(9," 12.11.1993 "),p.Tb(),p.Tb(),p.Tb(),p.Tb()),2&e){var t=n.$implicit;p.Db(2),p.mc("src",p.ic(3,1,t),p.Ac)}}var m=function(){function e(e,n){this.storage=e,this.authService=n,this.onNumberChange=new p.o}return e.prototype.ngOnInit=function(){var e=this;this.authService.user$.subscribe(function(n){n&&e.loadData(n)})},e.prototype.loadData=function(e){var n=this;this.storage.storage.ref("images/"+this.type+"/"+e.uid+"/").listAll().then(function(e){n.onNumberChange.emit(e.items.length),n.files=e.items.map(function(e){return Object(f.a)(e.getDownloadURL())})})},e.\u0275fac=function(n){return new(n||e)(p.Ob(u.a),p.Ob(r.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-my-files"]],inputs:{type:"type"},outputs:{onNumberChange:"onNumberChange"},decls:2,vars:1,consts:[[1,"image-container"],["class","image-holder",4,"ngFor","ngForOf"],[1,"image-holder"],[1,"wrapper"],["alt","",3,"src"],[1,"info"],[1,"title"],["href","https://unsplash.com/photos/zshyCr6HGw0","rel","noopener","target","_blank"],[1,"created"]],template:function(e,n){1&e&&(p.Ub(0,"div",0),p.Gc(1,h,10,3,"figure",1),p.Tb()),2&e&&(p.Db(1),p.mc("ngForOf",n.files))},directives:[o.l],pipes:[o.b],styles:[".image-container[_ngcontent-%COMP%]{position:relative;-moz-column-count:4;column-count:4;-moz-column-gap:0;column-gap:0}@media only screen and (max-width:1023px){.image-container[_ngcontent-%COMP%]{-moz-column-count:3;column-count:3}}@media only screen and (max-width:767px){.image-container[_ngcontent-%COMP%]{-moz-column-count:2;column-count:2}}@media only screen and (max-width:320px){.image-container[_ngcontent-%COMP%]{-moz-column-count:1;column-count:1}}.image-container[_ngcontent-%COMP%]   figure.image-holder[_ngcontent-%COMP%]{position:relative;display:inline-block;margin:0;overflow:hidden;border-radius:5px;padding:5px;width:100%}.image-container[_ngcontent-%COMP%]   figure.image-holder[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{position:relative;overflow:hidden;border-radius:5px;box-sizing:border-box}.image-container[_ngcontent-%COMP%]   figure.image-holder[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer;width:100%;filter:grayscale(0);transition:filter .3s;border-radius:5px;overflow:hidden}.image-container[_ngcontent-%COMP%]   figure.image-holder[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{background:rgba(0,0,0,.8);position:absolute;width:100%;height:0;transition:height .3s;line-height:40px;border-radius:0 0 5px 5px;padding:0 10px;box-sizing:border-box;bottom:5px;overflow:hidden}.image-container[_ngcontent-%COMP%]   figure.image-holder[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .created[_ngcontent-%COMP%]{float:right;color:#fff}.image-container[_ngcontent-%COMP%]   figure.image-holder[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:hover   .info[_ngcontent-%COMP%]{height:40px}.image-container[_ngcontent-%COMP%]   figure.image-holder[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{filter:grayscale(100%)}"]}),e}(),v=t("Wp6s"),w=t("wZkO"),x=t("nYR2"),y=t("/yY+"),C=t("dNgK"),O=t("1jcm"),_=function(){function e(){this.dropped=new p.o,this.hovered=new p.o}return e.prototype.onDrop=function(e){e.preventDefault(),e.dataTransfer&&this.dropped.emit(e.dataTransfer.files),this.hovered.emit(!1)},e.prototype.onDragOver=function(e){e.preventDefault(),this.hovered.emit(!0)},e.prototype.onDragLeave=function(e){e.preventDefault(),this.hovered.emit(!1)},e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=p.Jb({type:e,selectors:[["","appDropZone",""]],hostBindings:function(e,n){1&e&&p.cc("drop",function(e){return n.onDrop(e)})("dragover",function(e){return n.onDragOver(e)})("dragleave",function(e){return n.onDragLeave(e)})},outputs:{dropped:"dropped",hovered:"hovered"}}),e}(),M=t("kmnG"),P=t("qFsG"),U=t("/1cH"),T=t("FKr1"),I=t("bv9b"),k=t("sYmb");function D(e,n){if(1&e&&(p.Ub(0,"mat-option",19),p.Pb(1,"img",20),p.Ub(2,"span"),p.Ic(3),p.Tb(),p.Ic(4," \xa0 &nbsp "),p.Ub(5,"small"),p.Ic(6),p.Tb(),p.Tb()),2&e){var t=n.$implicit,o=p.gc(2).ngIf;p.mc("disabled",o.uid===t.uid)("value",t),p.Db(1),p.mc("src",t.photoURL,p.Ac),p.Db(2),p.Jc(t.displayName),p.Db(3),p.Jc(t.email)}}function F(e,n){if(1&e&&(p.Ub(0,"mat-form-field",14),p.Pb(1,"input",15),p.hc(2,"translate"),p.Ub(3,"mat-autocomplete",16,17),p.Gc(5,D,7,5,"mat-option",18),p.hc(6,"async"),p.Tb(),p.Tb()),2&e){var t=p.vc(4),o=p.gc(2);p.Db(1),p.nc("placeholder",p.ic(2,5,"common.shareWith")),p.mc("formControl",o.shareWith)("matAutocomplete",t),p.Db(2),p.mc("displayWith",o.mapper),p.Db(2),p.mc("ngForOf",p.ic(6,7,o.accounts))}}function S(e,n){}function G(e,n){if(1&e&&(p.Ub(0,"div"),p.Ic(1),p.Tb()),2&e){var t=n.$implicit;p.Db(1),p.Jc(t.name)}}function z(e,n){if(1&e&&p.Gc(0,G,2,1,"div",21),2&e){var t=p.gc(2);p.mc("ngForOf",t.files)}}function N(e,n){1&e&&(p.Ub(0,"strong"),p.Ic(1),p.hc(2,"translate"),p.Tb(),p.Ub(3,"span",22),p.Ic(4),p.hc(5,"translate"),p.Tb(),p.Ic(6,". ")),2&e&&(p.Db(1),p.Jc(p.ic(2,2,"files.chooseFile")),p.Db(3),p.Kc(" ",p.ic(5,4,"files.orDragItHere"),""))}var L=function(e){return{display:e}};function A(e,n){if(1&e&&(p.Ub(0,"div",24),p.Ub(1,"span",25),p.Ic(2),p.hc(3,"g43fileSize"),p.hc(4,"g43fileSize"),p.Tb(),p.Pb(5,"mat-progress-bar",26),p.Tb()),2&e){var t=n.ngIf,o=p.gc().ngIf,i=p.gc(2);p.mc("ngStyle",p.qc(8,L,i.isActive(o)?"block":"none")),p.Db(2),p.Lc("",p.ic(3,4,o.bytesTransferred)," of ",p.ic(4,6,o.totalBytes),""),p.Db(3),p.mc("value",t)}}function B(e,n){if(1&e&&(p.Ub(0,"div"),p.Gc(1,A,6,10,"div",23),p.hc(2,"async"),p.Tb()),2&e){var t=p.gc(2);p.Db(1),p.mc("ngIf",p.ic(2,1,t.percentage))}}var J=function(e){return{"is-dragover":e}};function W(e,n){if(1&e){var t=p.Vb();p.Ub(0,"div"),p.Ub(1,"div",1),p.Ub(2,"mat-slide-toggle",2),p.cc("ngModelChange",function(e){return p.xc(t),p.gc().shared=e}),p.Ic(3),p.hc(4,"translate"),p.Tb(),p.Gc(5,F,7,9,"mat-form-field",3),p.Tb(),p.Ub(6,"div",4),p.cc("dropped",function(e){return p.xc(t),p.gc().files=e})("hovered",function(e){return p.xc(t),p.gc().isHovering=e})("click",function(e){p.xc(t);var n=p.vc(10),o=p.vc(17);return p.gc().checkClick(e,n,o)}),p.fc(),p.Ub(7,"svg",5),p.Pb(8,"path",6),p.Tb(),p.ec(),p.Ub(9,"input",7,8),p.cc("change",function(){p.xc(t);var e=p.vc(10);return p.gc().files=e.files}),p.Tb(),p.Ub(11,"span",9),p.Gc(12,S,0,0,"ng-template"),p.Gc(13,z,1,1,"ng-template",10),p.Gc(14,N,7,6,"ng-template",null,11,p.Hc),p.Tb(),p.Ub(16,"button",12,13),p.cc("click",function(){p.xc(t);var e=n.ngIf,o=p.gc();return o.files.length&&o.startUpload(o.files,e)}),p.Ic(18,"Upload "),p.Tb(),p.Gc(19,B,3,3,"div",0),p.hc(20,"async"),p.Tb(),p.Tb()}if(2&e){var o=p.vc(15),i=p.gc();p.Db(2),p.mc("ngModel",i.shared),p.Db(1),p.Jc(p.ic(4,10,"common.share")),p.Db(2),p.mc("ngIf",i.shared),p.Db(1),p.mc("ngClass",p.qc(14,J,i.isHovering)),p.Db(7),p.mc("ngIfElse",o)("ngIf",i.files.length>0),p.Db(3),p.Gb("disabled",0==i.files.length),p.mc("disabled",0==i.files.length),p.Db(3),p.mc("ngIf",p.ic(20,12,i.snapshot))}}var j={length:0,item:function(e){return null}},R=function(){function e(e,n,t,o){this.authService=e,this.snackBar=n,this.analyticsService=t,this.fileUploadService=o,this.uploadTasks=[],this.files=j,this.onFileUploaded=new p.o,this.shareWith=new i.e,this.mapper=function(e){return e?e.displayName:null}}return e.prototype.ngOnInit=function(){this.accounts=this.authService.getAccounts()},e.prototype.startUpload=function(e,n){for(var t=this,o=this.shared&&this.shareWith.value?this.shareWith.value.uid:null,i=function(i){var c=e.item(i);if(!c)return"continue";a.analyticsService.eventUploadFile(c.name);try{var r=a.fileUploadService.uploadFile(c,n,o),s=a.uploadTasks.length;a.uploadTasks.push(r),a.percentage=r.percentageChanges,a.snapshot=r.snapshotChanges.pipe(Object(x.a)(function(){t.downloadUrl=r.ref.getDownloadURL(),t.files=j,t.onFileUploaded.emit(n),t.snackBar.open("S\xfabor bol \xfaspe\u0161ne nahrat\xfd","Zavrie\u0165"),t.uploadTasks.splice(s,1)}))}catch(l){a.snackBar.open("Pri uploade nastala chyba: "+l,"Zavrie\u0165")}},a=this,c=0;c<e.length;c++)i(c)},e.prototype.isActive=function(e){return"running"===e.state&&e.bytesTransferred<e.totalBytes},e.prototype.checkClick=function(e,n,t){e.target!==t&&n.click()},e.\u0275fac=function(n){return new(n||e)(p.Ob(r.a),p.Ob(C.b),p.Ob(y.a),p.Ob(g))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-file-upload"]],outputs:{onFileUploaded:"onFileUploaded"},decls:2,vars:3,consts:[[4,"ngIf"],[1,"share-options-wrapper",2,"margin-bottom","1em"],[1,"share-enable",3,"ngModel","ngModelChange"],["class","full-width share-autocomplete",4,"ngIf"],["appDropZone","",1,"box_input",3,"ngClass","dropped","hovered","click"],["height","43","viewBox","0 0 50 43","width","50","xmlns","http://www.w3.org/2000/svg",1,"box_icon"],["d","M48.4 26.5c-.9 0-1.7.7-1.7 1.7v11.6h-43.3v-11.6c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v13.2c0 .9.7 1.7 1.7 1.7h46.7c.9 0 1.7-.7 1.7-1.7v-13.2c0-1-.7-1.7-1.7-1.7zm-24.5 6.1c.3.3.8.5 1.2.5.4 0 .9-.2 1.2-.5l10-11.6c.7-.7.7-1.7 0-2.4s-1.7-.7-2.4 0l-7.1 8.3v-25.3c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v25.3l-7.1-8.3c-.7-.7-1.7-.7-2.4 0s-.7 1.7 0 2.4l10 11.6z"],["id","file_input","multiple","","type","file",1,"box_file",3,"change"],["file_input",""],[1,"label"],[3,"ngIfElse","ngIf"],["isEmpty",""],[1,"box_button",3,"disabled","click"],["upload_button",""],[1,"full-width","share-autocomplete"],["aria-label","State","matInput","",3,"formControl","matAutocomplete","placeholder"],[3,"displayWith"],["auto","matAutocomplete"],[3,"disabled","value",4,"ngFor","ngForOf"],[3,"disabled","value"],["alt","account photo","aria-hidden","",1,"example-option-img",3,"src"],[4,"ngFor","ngForOf"],[1,"box__dragndrop"],["class","progress-wrapper",3,"ngStyle",4,"ngIf"],[1,"progress-wrapper",3,"ngStyle"],[1,"progress"],["mode","determinate",3,"value"]],template:function(e,n){1&e&&(p.Gc(0,W,21,16,"div",0),p.hc(1,"async")),2&e&&p.mc("ngIf",p.ic(1,1,n.authService.user$))},directives:[o.m,O.a,i.n,i.q,_,o.k,M.c,P.b,i.c,U.c,i.f,U.a,o.l,T.m,o.n,I.a],pipes:[o.b,k.c],styles:[".share-options-wrapper[_ngcontent-%COMP%]{padding:1em;box-sizing:border-box;height:4em}.share-options-wrapper[_ngcontent-%COMP%]   .share-enable[_ngcontent-%COMP%]{display:inline-block;margin:1em}.share-options-wrapper[_ngcontent-%COMP%]   .share-autocomplete[_ngcontent-%COMP%]{display:inline-block;width:calc(70% - 3em)}.example-option-img[_ngcontent-%COMP%]{width:25px;height:25px;border-radius:50%;top:6px;margin-right:8px;position:relative}.box_input[_ngcontent-%COMP%]{outline:2px dashed #92b0b3;outline-offset:-10px;background-color:#c8dadf;font-size:1.25rem;position:relative;text-align:center;padding:20px;display:-ms-flexbox;display:flex;-ms-flex-flow:column;flex-flow:column;-ms-flex-pack:distribute;justify-content:space-around;-ms-flex-align:center;align-items:center;height:420px;transition:outline-offset .15s ease-in-out,background-color .15s linear}.box_input.is-dragover[_ngcontent-%COMP%]{outline-offset:-20px;outline-color:#c8dadf;background-color:#fff}.box_input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}.box_input[_ngcontent-%COMP%]   .box_icon[_ngcontent-%COMP%]{width:100%;height:80px;fill:#92b0b3;display:block;margin-bottom:40px}.box_input[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{max-width:100%;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;display:inline-block;overflow:hidden}.box_input[_ngcontent-%COMP%]   .progress-wrapper[_ngcontent-%COMP%]{width:100%}.box_input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#39bfd3;font-weight:700;color:#e5edf1;display:block;padding:8px 16px;width:100px;border:none;cursor:pointer}.box_input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0f3c4b}.box_input[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{background-color:#92b0b3;cursor:not-allowed}@media only screen and (max-height:556px){.box_input[_ngcontent-%COMP%]{height:calc(100vh - 136px - 4em)}.box_input[_ngcontent-%COMP%]   .box_icon[_ngcontent-%COMP%]{margin-bottom:10px}}"]}),e}(),E=t("TU8p");function H(e,n){if(1&e){var t=p.Vb();p.Ub(0,"app-file-upload",9),p.cc("onFileUploaded",function(e){return p.xc(t),p.gc(3).uploadComplete(e)}),p.Tb()}}function Y(e,n){1&e&&(p.Ub(0,"mat-tab",7),p.hc(1,"translate"),p.Gc(2,H,1,0,"ng-template",8),p.Tb()),2&e&&p.nc("label",p.ic(1,1,"files.upload.image"))}function Z(e,n){if(1&e&&(p.Ub(0,"span",10),p.Ic(1),p.hc(2,"translate"),p.Tb()),2&e){var t=p.gc(2);p.nc("matBadge",t.owned),p.Db(1),p.Jc(p.ic(2,2,"files.uploaded.images"))}}function q(e,n){if(1&e&&(p.Ub(0,"span",10),p.Ic(1),p.hc(2,"translate"),p.Tb()),2&e){var t=p.gc(2);p.nc("matBadge",t.shared),p.Db(1),p.Jc(p.ic(2,2,"files.sharedWithMe"))}}function K(e,n){if(1&e){var t=p.Vb();p.Ub(0,"div",1),p.Ub(1,"mat-tab-group"),p.Gc(2,Y,3,3,"mat-tab",2),p.Ub(3,"mat-tab",3),p.Gc(4,Z,3,4,"ng-template",4),p.Ub(5,"app-my-files",5),p.cc("onNumberChange",function(e){return p.xc(t),p.gc().owned=e}),p.Tb(),p.Tb(),p.Ub(6,"mat-tab",6),p.Gc(7,q,3,4,"ng-template",4),p.Ub(8,"app-my-files",5),p.cc("onNumberChange",function(e){return p.xc(t),p.gc().shared=e}),p.Tb(),p.Tb(),p.Tb(),p.Tb()}if(2&e){var o=n.ngIf,i=p.gc();p.Db(2),p.mc("ngIf",i.authService.checkAuthorization(o,i.Roles.ROLE_UPLOAD_FILES)),p.Db(3),p.mc("type","owned"),p.Db(3),p.mc("type","shared")}}var $=[{path:"",children:[{path:"",pathMatch:"full",component:function(){function e(e){this.authService=e,this.owned=0,this.shared=0,this.Roles=b.a}return e.prototype.ngOnInit=function(){},e.prototype.uploadComplete=function(e){this.children.forEach(function(n){return n.loadData(e)})},e.\u0275fac=function(n){return new(n||e)(p.Ob(r.a))},e.\u0275cmp=p.Ib({type:e,selectors:[["app-file-list"]],viewQuery:function(e,n){var t;1&e&&p.Mc(m,1),2&e&&p.uc(t=p.dc())&&(n.children=t)},decls:3,vars:3,consts:[["class","container",4,"ngIf"],[1,"container"],[3,"label",4,"ngIf"],["label","Nahrat\xe9 obr\xe1zky"],["mat-tab-label",""],[3,"type","onNumberChange"],["label","Zdielan\xe9 so mnou"],[3,"label"],["matTabContent",""],[3,"onFileUploaded"],["matBadgeOverlap","false",3,"matBadge"]],template:function(e,n){1&e&&(p.Ub(0,"mat-card"),p.Gc(1,K,9,3,"div",0),p.hc(2,"async"),p.Tb()),2&e&&(p.Db(1),p.mc("ngIf",p.ic(2,1,n.authService.user$)))},directives:[v.a,o.m,w.c,w.a,w.d,m,w.b,R,E.a],pipes:[o.b,k.c],styles:[".container[_ngcontent-%COMP%]{margin:0 auto;width:1024px}@media only screen and (max-width:1023px){.container[_ngcontent-%COMP%]{width:100%}}"]}),e}()}]}],V=function(){function e(){}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=p.Mb({type:e}),e.\u0275inj=p.Lb({imports:[[d.l.forChild($)],d.l]}),e}(),X=function(){function e(){}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=p.Mb({type:e}),e.\u0275inj=p.Lb({providers:[g],imports:[[c.a,a.a,V,o.c,i.j,i.s]]}),e}()}}]);