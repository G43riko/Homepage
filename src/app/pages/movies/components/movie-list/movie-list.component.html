<div class="top-controls">
    <section class="preview-type">
        <mat-button-toggle-group name="Preview type"
                                 [value]="previewType$ | async"
                                 (change)="setPreviewType($event.value)"
                                 aria-label="Preview type">
            <mat-button-toggle value="table">{{"movies.show.table" | translate}}</mat-button-toggle>
            <mat-button-toggle value="grid">{{"movies.show.grid" | translate}}</mat-button-toggle>
        </mat-button-toggle-group>
    </section>
    <button *menuItem="'end'" (click)="onToggleFilterClick()" mat-icon-button title="Toggle sidenav">
        <mat-icon>filter_alt</mat-icon>
    </button>
    <mat-form-field class="flex-grow-1">
        <input #searchPatter
               (input)="onSearchPatternChange(searchPatter.value)"
               matInput
               [placeholder]="'movies.search' | translate"
               type="search">
        <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>
</div>

<ng-container [ngSwitch]="previewType$ | async">
    <ng-container *ngSwitchCase="'table'" [ngTemplateOutlet]="previewTypeTable"></ng-container>
    <ng-container *ngSwitchCase="'grid'" [ngTemplateOutlet]="previewTypeGrid"></ng-container>
</ng-container>

<ng-template #previewTypeTable>
    <app-abstract-table [tableConfig]="movieConfig"
                        [data]="movieList$ | async">
        <div *tableColumn="'title', let row" class="flex-row">
            <img (click)="openMovieImages(row.avatar)"
                 *ngIf="row.avatar"
                 [src]="row.avatar[0]"
                 alt="row avatar" style="height: 42px; border-radius: 3px; margin-right: 1em; cursor: pointer">
            <div class="flex-column"
                 style="justify-content: space-between;">
                <strong>{{row.titleSk || row.title}}</strong>
                <div *ngIf="row.titleSk" class="sub header">{{row.title}}</div>
            </div>
        </div>
        <app-external-links *tableColumn="'external', let row" type="movie" [holder]="row"></app-external-links>
        <button *tableColumn="'detail'; let row"
                (click)="onShowMovieDetailClick(row.id)"
                color="primary"
                [matTooltip]="'movies.openDetail' | translate"
                mat-icon-button
        >
            <mat-icon>chevron_right</mat-icon>
        </button>

    </app-abstract-table>
</ng-template>

<ng-template #previewTypeGrid>
    <div class="grid-movies">
        <app-movie-poster-preview *ngFor="let movie of movieList$ | async"
                                  style="    margin-bottom: 1em;"
                                  [movie]="movie"></app-movie-poster-preview>
    </div>
    <div class="align-center">
        <button (click)="onLoadNext()"
                showAble
                (show)="onLoadNext()"
                class="next-loader"
                color="primary"
                mat-raised-button
        >{{'movies.loadNext' | translate}}
        </button>
    </div>
</ng-template>

<button mat-fab class="floating-add"
        [matTooltip]="'movies.addNew' | translate"
        (click)="onAddMovieClick()">
    <mat-icon>add</mat-icon>
</button>
